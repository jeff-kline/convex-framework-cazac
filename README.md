# Convex SOCP code listing (CAZAC / circulant Hadamard)

This repo contains a **runnable transcription** of the Python code listing included in the manuscript
*A Convex Programming Framework for Constructing CAZAC Sequences*.

The script solves the **augmented second‑order cone program** described in the paper’s phase‑constraint section,
then constructs a **block‑circulant complex Hadamard matrix** of size `(2n)×(2n)`:
\[
  H = \begin{pmatrix} X & Y \\ -Y^* & X^* \end{pmatrix},
\]
where `X` and `Y` are circulant matrices generated by two length‑`n` sequences.

## What the optimization enforces

Variables are `N` complex sequences `x_1, …, x_N ∈ C^n` (the listing uses `N=2`).

- **Amplitude bound** (outer approximation to constant modulus): `|x_j(k)| ≤ τ`
- **Joint spectral flatness bound**: `∑_j |FFT(x_j)(k)|^2 ≤ N n`
- **Phase‑window constraints** around the vertices of a regular `2q`‑gon (listing uses `q=2`, i.e. a square):
  the constraints are implemented exactly as in the listing using `ω_k = exp(i π (1/2 + k)/q)` and a slack `σ`.

The algorithm runs a short **presolve loop** that tightens `τ`, followed by a main loop at `τ=1` that updates the
objective direction `r` to the last solution.

## Quick start

Create a virtual environment and install dependencies:

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

Run the listing:

```bash
python cazac_code_listing.py
```

You should see output similar to 

```bash
Time (s):      5.5
Max |H(j,k)| 1.00000e+00
Min |H(j,k)| 1.00000e+00
Size H       (106, 106)
Condition(H) 1.00000e+00
```

## Parameters

In `main()` you can change:

- `n` : base sequence length (matrix is `2n × 2n` when `N=2`)
- `N` : number of coupled sequences (the block construction is implemented for `N=2`)
- `q` and `sigma` : phase‑window polygon and slack
- `L0`, `L`, `eps` : iteration counts and stopping tolerance
- `solver` : preferred cone solver (default tries Clarabel, then falls back)

## Notes

- The listing forms the DFT matrix via `F = fft(I_n)`, which is convenient but uses **O(n²)** memory.
  This is fine for the moderate sizes used in the manuscript experiments.
- CVXPY solver availability varies by platform. The script will try `CLARABEL`, then `ECOS`, then `SCS`.

## License

The manuscript states the code listing is released under **GNU GPL v3**.
If you publish this as a public repository, include a `LICENSE` file with the GPL‑3.0 text.

## Citation

If you use this code in academic work, cite the associated manuscript and the final venue version (once published).
